<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NGO Directory</title>
    <link rel="icon" href="/files/logo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Paytone+One&family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
    <style>
        * {
            padding: 0;
            margin: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
            text-decoration: none;
            list-style: none;
            scroll-behavior: smooth;
        }

        body {
            background-color: #0a0a0a;
            color: white;
        }

        /* Navbar */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(0, 20, 40, 0.97);
            color: white;
            padding: 0.7rem 2.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .navbar-logo {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo {
            width: 50px;
            height: 50px;
            filter: drop-shadow(0 0 5px rgba(0, 123, 255, 0.4));
        }

        .website-name {
            font-size: 2rem;
            font-weight: bold;
            letter-spacing: 0.5px;
            margin-top: 7px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .highlight-food {
            color: #007bff;
            position: relative;
        }

        .highlight-food:after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            height: 2px;
            width: 0;
            background: #007bff;
            transition: width 0.3s ease;
        }

        .navbar-logo:hover .highlight-food:after {
            width: 100%;
        }

        .navbar-links {
            display: flex;
            gap: 1.8rem;
        }

        .nav-link {
            color: #fff;
            font-size: 1.2rem;
            font-weight: 600;
            padding: 7px 15px;
            transition: all 0.3s ease;
            border-radius: 6px;
            position: relative;
        }

        .nav-link:after {
            content: '';
            position: absolute;
            bottom: 3px;
            left: 15px;
            height: 2px;
            width: 0;
            background: #007bff;
            transition: width 0.3s ease;
        }

        .nav-link:hover:after {
            width: calc(100% - 30px);
        }

        .nav-link:hover {
            color: #ffffff;
            background: rgba(0, 123, 255, 0.15);
            box-shadow: 0 0 15px rgba(0, 123, 255, 0.2);
        }

        .nav-link.active {
            background: rgba(0, 123, 255, 0.25);
            color: #ffffff;
        }

        /* Hamburger Menu */
        .hamburger {
            display: none;
            flex-direction: column;
            gap: 5px;
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            z-index: 1001;
        }

        .hamburger .line {
            width: 30px;
            height: 3px;
            background: white;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        /* NGO Directory specific styles */
        .ngo-section {
            padding: 120px 5% 80px;
            min-height: 100vh;
            background-color: #0a0a0a;
            background-image: linear-gradient(to bottom, #001029, #0a0a0a 300px);
            color: white;
        }

        .ngo-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .ngo-header {
            text-align: center;
            margin-bottom: 50px;
            padding: 20px 10px;
            border-radius: 15px;
            background: rgba(25, 25, 25, 0.5);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .ngo-header h1 {
            font-size: 60px;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #ffffff, #007bff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 5px 15px rgba(0, 123, 255, 0.1);
        }

        .ngo-header h1 span {
            color: #007bff;
            position: relative;
            background: linear-gradient(45deg, #007bff, #00d4ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .ngo-header p {
            font-size: 18px;
            color: #dddddd;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* Fade Animation */
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }

        .fade-in.show {
            opacity: 1;
            transform: translateY(0);
        }

        .state-select-container {
            position: relative;
            margin-bottom: 40px;
        }

        .state-select {
            width: 100%;
            padding: 17px 20px;
            background-color: #191919;
            font-size: 18px;
            border: 1px solid #333;
            border-radius: 12px;
            color: white;
            cursor: pointer;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .state-select:focus {
            border-color: #007bff;
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.3);
            outline: none;
        }

        .state-select-arrow {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
            font-size: 24px;
            color: #007bff;
        }

        .ngo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .ngo-card {
            background-color: #191919;
            border-radius: 15px;
            padding: 30px;
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
            border: 1px solid #333;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .ngo-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #007bff, #00d4ff);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.4s ease;
        }

        .ngo-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 123, 255, 0.15);
            border-color: rgba(0, 123, 255, 0.3);
        }

        .ngo-card:hover::before {
            transform: scaleX(1);
        }

        .ngo-card h3 {
            color: #007bff;
            margin-bottom: 20px;
            font-size: 24px;
            position: relative;
            padding-bottom: 10px;
        }

        .ngo-card h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 2px;
            background: #007bff;
        }

        .ngo-card p {
            color: #dddddd;
            margin-bottom: 12px;
            font-size: 16px;
            line-height: 1.5;
        }

        .ngo-card p strong {
            color: #2bac6b;
            font-weight: 600;
        }

        /* Registration Button Container */
        .register-button-container {
            text-align: center;
            margin: 30px 0 50px;
            padding: 35px 25px;
            background: linear-gradient(145deg, #191919, #202020);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
            border: 1px solid #333;
            position: relative;
            overflow: hidden;
        }

        .register-button-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(0, 123, 255, 0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .register-button-container:hover::before {
            opacity: 1;
        }

        .register-button-container h2 {
            font-size: 28px;
            margin-bottom: 15px;
            color: #ffffff;
        }

        .register-button-container p {
            color: #dddddd;
            margin-bottom: 25px;
            font-size: 18px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }

        .register-btn {
            background: linear-gradient(45deg, #007bff, #00a1ff);
            color: white;
            border: none;
            padding: 14px 35px;
            font-size: 18px;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.4);
        }

        .register-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .register-btn:hover {
            background: linear-gradient(45deg, #0056b3, #007bff);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 123, 255, 0.5);
        }

        .register-btn:hover::before {
            left: 100%;
        }

        /* Footer */
        .footer {
            background-color: #001529;
            padding-bottom: 15px;
            border-top: 1px solid #002a52;
        }

        .footer-content {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            padding: 40px 0 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .footlinks h4,
        .footlinkss h4 {
            margin-top: 10px;
            font-size: 20px;
            font-weight: 600;
            color: white;
            margin-bottom: 30px;
            position: relative;
        }

        .footlinkss h4 {
            margin-left: 100px;
        }

        .footlinks h4::before,
        .footlinkss h4::before {
            content: "";
            position: absolute;
            height: 3px;
            width: 70px;
            left: 0;
            bottom: -10px;
            background: linear-gradient(90deg, #007bff, transparent);
        }

        .footlinks ul li {
            margin-bottom: 15px;
        }

        .footlinks ul li a {
            font-size: 17px;
            color: #dddddd;
            display: block;
            transition: all 0.3s ease;
            padding: 3px 0;
        }

        .footlinks ul li a:hover {
            transform: translateX(6px);
            color: #007bff;
        }

        .social {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-left: 100px;
        }

        .social a {
            font-size: 22px;
            height: 45px;
            width: 45px;
            color: #001529;
            background: linear-gradient(45deg, #007bff, #00a1ff);
            display: inline-flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .social a:hover {
            transform: translateY(-5px) scale(1.1);
            background: white;
            color: #007bff;
            box-shadow: 0 10px 20px rgba(0, 123, 255, 0.3);
        }

        .end {
            text-align: center;
            padding-top: 30px;
            color: #a0a0a0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 70px 30px;
            background: linear-gradient(145deg, #191919, #202020);
            border-radius: 15px;
            margin: 30px auto;
            max-width: 800px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25);
            border: 1px solid #333;
        }

        .empty-state h2 {
            color: #007bff;
            margin-bottom: 20px;
            font-size: 32px;
        }

        .empty-state p {
            color: #dddddd;
            margin-bottom: 30px;
            font-size: 18px;
            line-height: 1.6;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Modal Styles - Fixed container with scrollable form */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: rgba(0, 0, 0, 0.85);
            opacity: 0;
            transition: opacity 0.3s ease;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        .modal.show {
            opacity: 1;
        }

        .modal-content {
            background-color: #191919;
            margin: 5vh auto;
            padding: 35px 40px;
            border-radius: 15px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.1);
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            transform: translateY(-50px);
            opacity: 0;
            transition: all 0.4s ease;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .modal.show .modal-content {
            transform: translateY(0);
            opacity: 1;
        }

        .modal-header {
            position: relative;
            padding-bottom: 20px;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-title {
            font-size: 28px;
            color: #007bff;
            text-align: center;
            margin-bottom: 0;
        }

        .close {
            position: absolute;
            right: 0;
            top: 0;
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close:hover {
            color: #007bff;
            background-color: rgba(255, 255, 255, 0.1);
        }

        .form-container {
            overflow-y: auto;
            padding-right: 10px;
            margin-right: -10px;
            max-height: calc(90vh - 150px);
            scrollbar-width: thin;
            scrollbar-color: #007bff #2a2a2a;
        }

        .form-container::-webkit-scrollbar {
            width: 6px;
            background-color: #2a2a2a;
            border-radius: 3px;
        }

        .form-container::-webkit-scrollbar-thumb {
            background-color: #007bff;
            border-radius: 3px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            color: #ffffff;
            margin-bottom: 10px;
            font-size: 16px;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 14px 16px;
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);
            outline: none;
        }

        .form-group textarea {
            height: 120px;
            resize: vertical;
            line-height: 1.6;
        }

        .submit-btn {
            background: linear-gradient(45deg, #007bff, #00a1ff);
            color: white;
            border: none;
            padding: 14px 30px;
            font-size: 18px;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            margin-top: 10px;
            position: relative;
            overflow: hidden;
        }

        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .submit-btn:hover {
            background: linear-gradient(45deg, #0056b3, #007bff);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .submit-btn:hover::before {
            left: 100%;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            display: none;
            z-index:
            2500;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .toast.error {
            background: linear-gradient(45deg, #dc3545, #ff5c69);
        }

        @media screen and (max-width: 768px) {
            .navbar {
                padding: 0.7rem 1.5rem;
            }

            .navbar-links {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 70px;
                right: 15px;
                background: rgba(0, 20, 40, 0.97);
                padding: 1.2rem;
                border-radius: 10px;
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.1);
            }

            .navbar-links.active {
                display: flex;
            }

            .nav-link {
                padding: 12px 20px;
                width: 100%;
                text-align: center;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }

            .nav-link:last-child {
                border-bottom: none;
            }

            .hamburger {
                display: flex;
                flex-direction: column;
                gap: 5px;
                background: none;
                border: none;
                cursor: pointer;
            }

            .hamburger .line {
                width: 30px;
                height: 3px;
                background: white;
                border-radius: 3px;
                transition: all 0.3s ease;
            }

            .hamburger.active .line:nth-child(1) {
                transform: translateY(8px) rotate(45deg);
            }

            .hamburger.active .line:nth-child(2) {
                opacity: 0;
            }

            .hamburger.active .line:nth-child(3) {
                transform: translateY(-8px) rotate(-45deg);
            }

            .ngo-header h1 {
                font-size: 40px;
            }

            .ngo-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 95%;
                margin: 5vh auto;
                padding: 25px;
            }

            .footlinkss h4, .social {
                margin-left: 0;
                margin-top: 30px;
            }

            .footer-content {
                flex-direction: column;
                padding: 30px 20px;
                gap: 20px;
            }
        }

        @media screen and (max-width: 480px) {
            .ngo-header h1 {
                font-size: 32px;
            }

            .register-button-container h2 {
                font-size: 24px;
            }

            .register-button-container p {
                font-size: 16px;
            }

            .register-btn {
                padding: 12px 25px;
                font-size: 16px;
            }

            .modal-title {
                font-size: 24px;
            }

            .state-select {
                padding: 14px 16px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar from donate.ejs -->
    <nav class="navbar fade-in">
        <div class="navbar-logo">
            <img src="/files/logo.png" alt="Logo" class="logo">
            <span class="website-name">Food<span class="highlight-food">Yield</span></span>
        </div>
        <div class="navbar-links">
            <a href="/" class="nav-link">Home</a>
            <a href="/info" class="nav-link">Donate</a>
            <a href="/reqfood" class="nav-link">Ask for Donate</a>
            <a href="/viewrequests" class="nav-link">Requests</a>
            <a href="/donations" class="nav-link">Available Donations</a>
            <a href="/register" class="nav-link">Administration</a>
        </div>
        <button class="hamburger" id="hamburger-btn">
            <div class="line"></div>
            <div class="line"></div>
            <div class="line"></div>
        </button>
    </nav>

    <!-- NGO Directory Section -->
    <section class="ngo-section fade-in">
        <div class="ngo-container">
            <div class="ngo-header">
                <h1>NGO <span>Directory</span></h1>
                <p>Find NGOs in your state that can help distribute food to those in need</p>
            </div>
            
            <div class="state-select-container fade-in">
                <select id="state-select" class="state-select">
                    <option selected>Select your state</option>
                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                    <option value="Assam">Assam</option>
                    <option value="Bihar">Bihar</option>
                    <option value="Chhattisgarh">Chhattisgarh</option>
                    <option value="Goa">Goa</option>
                    <option value="Gujarat">Gujarat</option>
                    <option value="Haryana">Haryana</option>
                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                    <option value="Jharkhand">Jharkhand</option>
                    <option value="Karnataka">Karnataka</option>
                    <option value="Kerala">Kerala</option>
                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                    <option value="Maharashtra">Maharashtra</option>
                    <option value="Manipur">Manipur</option>
                    <option value="Meghalaya">Meghalaya</option>
                    <option value="Mizoram">Mizoram</option>
                    <option value="Nagaland">Nagaland</option>
                    <option value="Odisha">Odisha</option>
                    <option value="Punjab">Punjab</option>
                    <option value="Rajasthan">Rajasthan</option>
                    <option value="Sikkim">Sikkim</option>
                    <option value="Tamil Nadu">Tamil Nadu</option>
                    <option value="Telangana">Telangana</option>
                    <option value="Tripura">Tripura</option>
                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                    <option value="Uttarakhand">Uttarakhand</option>
                    <option value="West Bengal">West Bengal</option>
                </select>
                <div class="state-select-arrow">
                    <i class='bx bx-chevron-down'></i>
                </div>
            </div>

            <div class="empty-state fade-in" id="empty-state">
                <h2>No NGOs Registered Yet</h2>
                <p>Are you an NGO working to reduce food waste and hunger? Register your organization to connect with donors who want to contribute excess food. Help bridge the gap between food surplus and hunger.</p>
                <button class="register-btn" id="empty-state-register-btn">Register Your NGO</button>
            </div>

            <div class="ngo-grid fade-in" id="ngo-list">
                <!-- NGOs will be displayed here -->
                <% if(ngos && ngos.length > 0) { %>
                    <% for(let ngo of ngos) { %>
                        <div class="ngo-card">
                            <h3><%= ngo.name %></h3>
                            <p><strong>Location:</strong> <%= ngo.address %></p>
                            <p><strong>Contact:</strong> <%= ngo.contactPhone %></p>
                            <p><strong>Email:</strong> <%= ngo.email %></p>
                            <p><strong>Incharge:</strong> <%= ngo.inchargeName %></p>
                            <p><strong>Bio:</strong> <%= ngo.bio %></p>
                        </div>
                    <% } %>
                <% } %>
            </div>
        </div>
        <!-- Always visible register button -->
        <div class="register-button-container fade-in">
            <h2>Are you an NGO?</h2>
            <p>Register your organization to connect with donors who want to contribute excess food.</p>
            <button class="register-btn" id="registerBtn">Register Your NGO</button>
        </div>
    </section>

    <!-- NGO Registration Modal with Fixed Container and Scrollable Form -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Register Your NGO</h2>
                <span class="close">&times;</span>
            </div>
            <div class="form-container">
                <form id="ngoForm">
                    <div class="form-group">
                        <label for="name">NGO/Organization Name</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="inchargeName">Incharge Name</label>
                        <input type="text" id="inchargeName" name="inchargeName" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="contactPhone">Contact Phone</label>
                        <input type="tel" id="contactPhone" name="contactPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="address">Address</label>
                        <input type="text" id="address" name="address" required>
                    </div>
                    <div class="form-group">
                        <label for="state">State</label>
                        <input type="text" id="state" name="state" required>
                    </div>
                    <div class="form-group">
                        <label for="bio">Short Bio/Description</label>
                        <textarea id="bio" name="bio" required></textarea>
                    </div>
                    <button type="submit" class="submit-btn">Register</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">Registration successful!</div>

    <!-- Footer from donate.ejs -->
    <section class="footer fade-in">
        <div class="footer-content">
            <div class="footlinks">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="/info">Donate</a></li>
                    <li><a href="about.html">About Us</a></li>
                    <li><a href="contact.html">Contact Us</a></li>
                </ul>
            </div>
            <div class="footlinkss">
                <h4>Connect</h4>
                <div class="social">
                    <a href="#"><i class='bx bxl-facebook'></i></a>
                    <a href="#"><i class='bx bxl-instagram'></i></a>
                    <a href="#"><i class='bx bxl-twitter'></i></a>
                    <a href="#"><i class='bx bxl-linkedin'></i></a>
                    <a href="#"><i class='bx bxl-youtube'></i></a>
                    <a href="#"><i class='bx bxl-github'></i></a>
                </div>
            </div>
        </div>
        <div class="end">
            <p>Copyright Â© 2023 FoodYield | All Rights Reserved.</p>
        </div>
    </section>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const stateSelect = document.getElementById('state-select');
            const ngoList = document.getElementById('ngo-list');
            const emptyState = document.getElementById('empty-state');
            const hamburgerBtn = document.getElementById('hamburger-btn');
            
            // Check if there are existing NGOs
            if (ngoList.children.length === 0) {
                emptyState.style.display = 'block';
            } else {
                emptyState.style.display = 'none';
            }
            
            // Hamburger menu toggle
            hamburgerBtn.addEventListener('click', function() {
                const navbarLinks = document.querySelector('.navbar-links');
                navbarLinks.classList.toggle('active');
                this.classList.toggle('active');
            });
            
            // Modal functionality
            const modal = document.getElementById("registerModal");
            const registerBtn = document.getElementById("registerBtn");
            const emptyStateRegisterBtn = document.getElementById("empty-state-register-btn");
            const span = document.getElementsByClassName("close")[0];
            const toast = document.getElementById("toast");
            
            // Register button event listeners
            registerBtn.onclick = function() {
                openModal();
            }
            
            if (emptyStateRegisterBtn) {
                emptyStateRegisterBtn.onclick = function() {
                    openModal();
                }
            }
            
            function openModal() {
                document.body.style.overflow = 'hidden'; // Prevent body scrolling when modal is open
                modal.style.display = "block";
                setTimeout(() => {
                    modal.classList.add("show");
                }, 10);
            }
            
            function closeModal() {
                modal.classList.remove("show");
                setTimeout(() => {
                    modal.style.display = "none";
                    document.body.style.overflow = ''; // Restore body scrolling
                }, 300);
            }
            
            span.onclick = function() {
                closeModal();
            }
            
            window.onclick = function(event) {
                if (event.target == modal) {
                    closeModal();
                }
            }
            
            // Escape key closes modal
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && modal.style.display === 'block') {
                    closeModal();
                }
            });
            
            // Form submission
            document.getElementById("ngoForm").addEventListener("submit", function(e) {
                e.preventDefault();
                
                const formData = {
                    name: document.getElementById("name").value,
                    inchargeName: document.getElementById("inchargeName").value,
                    email: document.getElementById("email").value,
                    contactPhone: document.getElementById("contactPhone").value,
                    address: document.getElementById("address").value,
                    state: document.getElementById("state").value,
                    bio: document.getElementById("bio").value
                };
                
                // Show loading state on button
                const submitBtn = this.querySelector('.submit-btn');
                const originalBtnText = submitBtn.innerText;
                submitBtn.innerText = 'Registering...';
                submitBtn.disabled = true;
                
                fetch('/register-ngo', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                })
                .then(response => response.json())
                .then(data => {
                    // Reset button state
                    submitBtn.innerText = originalBtnText;
                    submitBtn.disabled = false;
                    
                    if (data.success) {
                        // Close modal
                        closeModal();
                        
                        // Clear form
                        document.getElementById("ngoForm").reset();
                        
                        // Show toast notification
                        toast.classList.remove("error");
                        toast.textContent = "Registration successful!";
                        toast.style.display = "block";
                        setTimeout(() => {
                            toast.classList.add("show");
                        }, 10);
                        
                        // Hide toast after 3 seconds
                        setTimeout(() => {
                            toast.classList.remove("show");
                            setTimeout(() => {
                                toast.style.display = "none";
                            }, 300);
                        }, 3000);
                        
                        // Reload the page to show the new NGO
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000);
                    } else {
                        // Show error toast
                        toast.classList.add("error");
                        toast.textContent = data.message || "Registration failed!";
                        toast.style.display = "block";
                        setTimeout(() => {
                            toast.classList.add("show");
                        }, 10);
                        
                        // Hide toast after 3 seconds
                        setTimeout(() => {
                            toast.classList.remove("show");
                            setTimeout(() => {
                                toast.style.display = "none";
                            }, 300);
                        }, 3000);
                    }
                })
                .catch(error => {
                    // Reset button state
                    submitBtn.innerText = originalBtnText;
                    submitBtn.disabled = false;
                    
                    console.error('Error:', error);
                    // Show error toast
                    toast.classList.add("error");
                    toast.textContent = "An error occurred. Please try again.";
                    toast.style.display = "block";
                    setTimeout(() => {
                        toast.classList.add("show");
                    }, 10);
                    
                    // Hide toast after 3 seconds
                    setTimeout(() => {
                        toast.classList.remove("show");
                        setTimeout(() => {
                            toast.style.display = "none";
                        }, 300);
                    }, 3000);
                });
            });
        });

// Filter NGOs by state
document.getElementById('state-select').addEventListener('change', function() {
    const selectedState = this.value;
    const ngoCards = document.querySelectorAll('.ngo-card');
    let foundMatches = false;
    const emptyState = document.getElementById('empty-state');
    const emptyStateHeading = emptyState.querySelector('h2');
    const emptyStateText = emptyState.querySelector('p');

    if (selectedState === "Select your state") {
        // Reset empty state message to default
        emptyStateHeading.textContent = "No NGOs Registered Yet";
        emptyStateText.textContent = "Are you an NGO working to reduce food waste and hunger? Register your organization to connect with donors who want to contribute excess food. Help bridge the gap between food surplus and hunger.";
        
        // Show all NGOs
        ngoCards.forEach(card => {
            card.style.display = 'block';
        });
        foundMatches = ngoCards.length > 0;
    } else {
        // Update empty state message to be state-specific
        emptyStateHeading.textContent = `No NGOs Registered Yet in ${selectedState}`;
        emptyStateText.textContent = `We don't have any NGOs registered in ${selectedState} yet. Are you an NGO working in ${selectedState} to reduce food waste and hunger? Register your organization to connect with donors who want to contribute excess food.`;
        
        // Show only NGOs from the selected state
        ngoCards.forEach(card => {
            const locationText = card.querySelector('p:nth-of-type(1)').textContent;
            if (locationText.includes(selectedState)) {
                card.style.display = 'block';
                foundMatches = true;
            } else {
                card.style.display = 'none';
            }
        });
    }
    
    // Show or hide empty state message based on filter results
    if (!foundMatches) {
        emptyState.style.display = 'block';
        // Ensure the fade-in animation works
        setTimeout(() => {
            emptyState.classList.add('show');
        }, 10);
    } else {
        emptyState.style.display = 'none';
    }
});

        // Click outside to close menu
        document.addEventListener('click', function(event) {
            const navbar = document.querySelector('.navbar');
            const navbarLinks = document.querySelector('.navbar-links');
            const hamburger = document.querySelector('.hamburger');

            if (navbarLinks.classList.contains('active') && 
                !navbar.contains(event.target) && 
                !hamburger.contains(event.target)) {
                navbarLinks.classList.remove('active');
                hamburger.classList.remove('active');
            }
        });

        // Fade-in animation
        document.addEventListener("DOMContentLoaded", () => {
            const fadeInElements = document.querySelectorAll('.fade-in');

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('show');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });

            fadeInElements.forEach(el => observer.observe(el));
        });
        
        // Auto-focus first input when modal opens
        document.getElementById('registerBtn').addEventListener('click', function() {
            setTimeout(() => {
                document.getElementById('name').focus();
            }, 500);
        });
        
        // Prevent form submission when pressing Enter on inputs except textarea
        document.querySelectorAll('.form-group input').forEach(input => {
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const formGroups = Array.from(document.querySelectorAll('.form-group'));
                    const currentIndex = formGroups.findIndex(fg => fg.contains(this));
                    if (currentIndex < formGroups.length - 1) {
                        const nextInput = formGroups[currentIndex + 1].querySelector('input, textarea');
                        if (nextInput) nextInput.focus();
                    }
                }
            });
        });
    </script>
</body>
</html>